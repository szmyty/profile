# Pre-commit hooks configuration
# Install with: pre-commit install
# Run manually with: pre-commit run --all-files

repos:
  # General file checks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: trailing-whitespace
        args: [--markdown-linebreak-ext=md]
      - id: end-of-file-fixer
      - id: check-yaml
        args: [--allow-multiple-documents]
      - id: check-json
        files: \.(json)$
      - id: check-added-large-files
        args: [--maxkb=1000]
      - id: check-merge-conflict
      - id: check-executables-have-shebangs
      - id: check-shebang-scripts-are-executable

  # JSON Schema validation
  - repo: https://github.com/python-jsonschema/check-jsonschema
    rev: 0.30.0
    hooks:
      - id: check-jsonschema
        name: Validate developer stats against schema
        files: ^developer/stats\.json$
        args: [--schemafile, schemas/developer-stats.schema.json]
      - id: check-jsonschema
        name: Validate Oura metrics against schema
        files: ^oura/metrics\.json$
        args: [--schemafile, schemas/oura-metrics.schema.json]
      - id: check-jsonschema
        name: Validate weather data against schema
        files: ^weather/weather\.json$
        args: [--schemafile, schemas/weather.schema.json]
      - id: check-jsonschema
        name: Validate SoundCloud metadata against schema
        files: ^assets/metadata\.json$
        args: [--schemafile, schemas/soundcloud-track.schema.json]
      - id: check-jsonschema
        name: Validate health snapshot against schema
        files: ^oura/health_snapshot\.json$
        args: [--schemafile, schemas/health-snapshot.schema.json]

  # Python formatting and linting
  - repo: https://github.com/psf/black
    rev: 24.10.0
    hooks:
      - id: black
        language_version: python3.11
        args: [--line-length=100]

  - repo: https://github.com/pycqa/isort
    rev: 5.13.2
    hooks:
      - id: isort
        args: [--profile=black, --line-length=100]

  - repo: https://github.com/pycqa/flake8
    rev: 7.1.1
    hooks:
      - id: flake8
        args: [--max-line-length=100, --extend-ignore=E203,W503]

  # Shell script validation
  - repo: https://github.com/shellcheck-py/shellcheck-py
    rev: v0.10.0.1
    hooks:
      - id: shellcheck
        args: [--severity=warning]

  # SVG optimization and validation
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v4.0.0-alpha.8
    hooks:
      - id: prettier
        types_or: [svg, json, yaml, markdown]
        args: [--write]

  # Custom markdown linting
  - repo: local
    hooks:
      - id: lint-markdown-images
        name: Lint markdown images in HTML blocks
        entry: python scripts/lint-markdown-images.py
        language: system
        types: [markdown]
        files: ^README\.md$
        pass_filenames: true
